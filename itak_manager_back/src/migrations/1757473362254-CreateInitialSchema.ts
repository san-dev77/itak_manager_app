import { MigrationInterface, QueryRunner } from "typeorm";

export class CreateInitialSchema1757473362254 implements MigrationInterface {
    name = 'CreateInitialSchema1757473362254'

    public async up(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`CREATE TABLE "teaching_assignments" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "teacher_id" uuid NOT NULL, "class_subject_id" uuid NOT NULL, "start_date" date NOT NULL, "end_date" date, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_c149bbbb99fa6464cdb26612d31" UNIQUE ("teacher_id", "class_subject_id"), CONSTRAINT "chk_end_date_after_start" CHECK (end_date IS NULL OR end_date >= start_date), CONSTRAINT "chk_start_date_not_future" CHECK (start_date <= CURRENT_DATE), CONSTRAINT "PK_baf0d10098561a9840957b512e0" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_7eb84b6d68b1db6cc46b5fcea9" ON "teaching_assignments" ("teacher_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_074e7e672063e0b76786f67cd0" ON "teaching_assignments" ("class_subject_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_e0f83525a7bfd679c02107652c" ON "teaching_assignments" ("start_date") `);
        await queryRunner.query(`CREATE INDEX "IDX_360b1f9ed98b16ad3f076084cf" ON "teaching_assignments" ("end_date") `);
        await queryRunner.query(`CREATE TABLE "teachers" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "user_id" uuid NOT NULL, "matricule" character varying(20) NOT NULL, "hire_date" date NOT NULL, "photo" text, "marital_status" character varying(20), "diplomas" text, "address" text, "emergency_contact" character varying(100), "notes" text, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_4668d4752e6766682d1be0b346f" UNIQUE ("user_id"), CONSTRAINT "UQ_4da9777c79b35eb3a0fcdcd833e" UNIQUE ("matricule"), CONSTRAINT "PK_a8d4f83be3abe4c687b0a0093c8" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_4668d4752e6766682d1be0b346" ON "teachers" ("user_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_4da9777c79b35eb3a0fcdcd833" ON "teachers" ("matricule") `);
        await queryRunner.query(`CREATE INDEX "IDX_bc8ceddb4c4419b52ff7ff5c3b" ON "teachers" ("hire_date") `);
        await queryRunner.query(`CREATE TABLE "subjects" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "name" character varying(50) NOT NULL, "code" character varying(10) NOT NULL, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_542cbba74dde3c82ab49c573109" UNIQUE ("code"), CONSTRAINT "PK_1a023685ac2b051b4e557b0b280" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_47a287fe64bd0e1027e603c335" ON "subjects" ("name") `);
        await queryRunner.query(`CREATE INDEX "IDX_542cbba74dde3c82ab49c57310" ON "subjects" ("code") `);
        await queryRunner.query(`CREATE TABLE "school_years" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "name" character varying(20) NOT NULL, "start_date" date NOT NULL, "end_date" date NOT NULL, "is_active" boolean NOT NULL DEFAULT false, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_687611dadc1a5966e0365e4f492" UNIQUE ("name"), CONSTRAINT "PK_3fe99d570a61178cb99065783cf" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_687611dadc1a5966e0365e4f49" ON "school_years" ("name") `);
        await queryRunner.query(`CREATE INDEX "IDX_975c55d642528a2f478e8d7666" ON "school_years" ("start_date") `);
        await queryRunner.query(`CREATE INDEX "IDX_478a2d98422fb3b99dcb31b6e6" ON "school_years" ("end_date") `);
        await queryRunner.query(`CREATE INDEX "IDX_5e9b2616fdad7b0d3c33c93fe0" ON "school_years" ("is_active") `);
        await queryRunner.query(`CREATE TABLE "terms" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "school_year_id" uuid NOT NULL, "name" character varying(20) NOT NULL, "start_date" date NOT NULL, "end_date" date NOT NULL, "is_active" boolean NOT NULL DEFAULT false, "order_number" integer NOT NULL DEFAULT '1', "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), "schoolYearId" uuid, CONSTRAINT "PK_33b6fe77d6ace7ff43cc8a65958" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_3ee8b061e5cb4972f9a2953a95" ON "terms" ("school_year_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_79b56b84207dc3c5510bb093d3" ON "terms" ("name") `);
        await queryRunner.query(`CREATE INDEX "IDX_c7ac94655c7dc1edd0b5b01547" ON "terms" ("start_date") `);
        await queryRunner.query(`CREATE INDEX "IDX_6811439bf289b3bb6de197648b" ON "terms" ("end_date") `);
        await queryRunner.query(`CREATE INDEX "IDX_e5f8a2f92f738911997eebc794" ON "terms" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "IDX_a24ac15b9a8c74a4c7e8fdfb22" ON "terms" ("order_number") `);
        await queryRunner.query(`CREATE TABLE "assessment_results" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "assessment_id" uuid NOT NULL, "student_id" uuid NOT NULL, "score" numeric(5,2) NOT NULL, "remarks" text, "is_absent" boolean NOT NULL DEFAULT false, "is_excused" boolean NOT NULL DEFAULT false, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "PK_5907c861a69b7bf628090784637" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE UNIQUE INDEX "IDX_fe3eef76d2c914c686d29ccde7" ON "assessment_results" ("assessment_id", "student_id") `);
        await queryRunner.query(`CREATE TYPE "public"."grade_complaints_status_enum" AS ENUM('pending', 'under_review', 'approved', 'rejected')`);
        await queryRunner.query(`CREATE TABLE "grade_complaints" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "student_id" uuid NOT NULL, "assessment_id" uuid NOT NULL, "status" "public"."grade_complaints_status_enum" NOT NULL DEFAULT 'pending', "reason" text NOT NULL, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "PK_46c7901313d69fc712fb4534bc9" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_34d2b5c89e1a3b4f458dcbc9c7" ON "grade_complaints" ("student_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_04342a18ea7141b9069f460eb1" ON "grade_complaints" ("assessment_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_f9f21013dce950782fced82b00" ON "grade_complaints" ("status") `);
        await queryRunner.query(`CREATE TYPE "public"."assessment_subjects_file_type_enum" AS ENUM('pdf', 'doc', 'docx', 'odt')`);
        await queryRunner.query(`CREATE TABLE "assessment_subjects" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "assessment_id" uuid NOT NULL, "file_url" text NOT NULL, "file_type" "public"."assessment_subjects_file_type_enum" NOT NULL, "uploaded_by" uuid NOT NULL, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "PK_d846f59e632a08b875d7fc720b2" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_32c0056f4a8acc773ab38fb3e5" ON "assessment_subjects" ("assessment_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_37ece249a758b7bc5a8a9ae126" ON "assessment_subjects" ("uploaded_by") `);
        await queryRunner.query(`CREATE TYPE "public"."assessments_type_enum" AS ENUM('exam', 'homework', 'supervised_homework', 'test', 'quiz', 'monthly_composition', 'continuous_assessment')`);
        await queryRunner.query(`CREATE TABLE "assessments" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "term_id" uuid NOT NULL, "class_subject_id" uuid NOT NULL, "type" "public"."assessments_type_enum" NOT NULL DEFAULT 'test', "title" character varying(100) NOT NULL, "description" text, "start_date" date NOT NULL, "end_date" date NOT NULL, "max_score" numeric(5,2) NOT NULL, "weight" numeric(5,2) NOT NULL DEFAULT '1', "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), "termId" uuid, "classSubjectId" uuid, CONSTRAINT "PK_a3442bd80a00e9111cefca57f6c" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_0fc9facafe432c9a5fcb6a00d4" ON "assessments" ("term_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_2b73c535109b7f105941e83b81" ON "assessments" ("class_subject_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_44e86abcddcbf3cbdb90502c69" ON "assessments" ("type") `);
        await queryRunner.query(`CREATE INDEX "IDX_fa6c13bd0f1077f9bd02235112" ON "assessments" ("title") `);
        await queryRunner.query(`CREATE INDEX "IDX_35e24da9b85a5fa69de3e049b7" ON "assessments" ("start_date") `);
        await queryRunner.query(`CREATE INDEX "IDX_949e337542feac3095503a3693" ON "assessments" ("end_date") `);
        await queryRunner.query(`CREATE TABLE "class_subjects" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "class_id" uuid NOT NULL, "subject_id" uuid NOT NULL, "coefficient" integer NOT NULL DEFAULT '1', "weekly_hours" integer, "is_optional" boolean NOT NULL DEFAULT false, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_bd863400a0b317b7e43118a970b" UNIQUE ("class_id", "subject_id"), CONSTRAINT "chk_weekly_hours_positive" CHECK (weekly_hours IS NULL OR weekly_hours >= 0), CONSTRAINT "chk_coefficient_positive" CHECK (coefficient >= 0), CONSTRAINT "PK_4e1ecabd8771166a29291dc09ed" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_433f93dd22b685e59c285726a1" ON "class_subjects" ("class_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_9d8971acdcc64a1703357a0075" ON "class_subjects" ("subject_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_99dddf68bda3b92f23f0039c36" ON "class_subjects" ("coefficient") `);
        await queryRunner.query(`CREATE TABLE "class_category" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "name" character varying(50) NOT NULL, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_57121e4285ce95dcb67dce5f77f" UNIQUE ("name"), CONSTRAINT "PK_903c13b4bea96ee4844ad7abd9e" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_57121e4285ce95dcb67dce5f77" ON "class_category" ("name") `);
        await queryRunner.query(`CREATE TABLE "classes" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "name" character varying(50) NOT NULL, "code" character varying(10) NOT NULL, "description" text, "level" character varying(20), "category_id" uuid NOT NULL, "capacity" integer, "order_level" integer NOT NULL, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), "class_category_id" uuid, CONSTRAINT "UQ_cf7491878e0fca8599438629988" UNIQUE ("code"), CONSTRAINT "PK_e207aa15404e9b2ce35910f9f7f" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_1f3940af28a76098f31004f03c" ON "classes" ("name") `);
        await queryRunner.query(`CREATE INDEX "IDX_cf7491878e0fca859943862998" ON "classes" ("code") `);
        await queryRunner.query(`CREATE INDEX "IDX_7f3d4d1ac00ffae553798f09d1" ON "classes" ("category_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_bebfac8b20c611dc0a5ffeca97" ON "classes" ("order_level") `);
        await queryRunner.query(`CREATE TABLE "student_classes" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "student_id" uuid NOT NULL, "class_id" uuid NOT NULL, "start_date" date NOT NULL, "end_date" date, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_72cb908330b0e7eac3846c0998b" UNIQUE ("student_id", "class_id"), CONSTRAINT "chk_end_date_after_start" CHECK (end_date IS NULL OR end_date >= start_date), CONSTRAINT "chk_start_date_not_future" CHECK (start_date <= CURRENT_DATE), CONSTRAINT "PK_e6fcc2e4f8f79a5aa16a50c8f46" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_09b94eccbdedd86b77d54daaeb" ON "student_classes" ("student_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_250de2754beaff18091a60a665" ON "student_classes" ("class_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_fe3b07f79392a7333d197c8852" ON "student_classes" ("start_date") `);
        await queryRunner.query(`CREATE INDEX "IDX_0f3d7aaa500b257483674cc898" ON "student_classes" ("end_date") `);
        await queryRunner.query(`CREATE TABLE "parents" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "user_id" uuid NOT NULL, "job" character varying(100), "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_c94c3cea9b43a18c81269ded41d" UNIQUE ("user_id"), CONSTRAINT "PK_9a4dc67c7b8e6a9cb918938d353" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_c94c3cea9b43a18c81269ded41" ON "parents" ("user_id") `);
        await queryRunner.query(`CREATE TYPE "public"."student_parents_relationship_enum" AS ENUM('père', 'mère', 'tuteur', 'beau-père', 'belle-mère', 'grand-père', 'grand-mère', 'autre')`);
        await queryRunner.query(`CREATE TABLE "student_parents" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "student_id" uuid NOT NULL, "parent_id" uuid NOT NULL, "relationship" "public"."student_parents_relationship_enum" NOT NULL DEFAULT 'père', "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_ad07904dc74a079fb1d7d82825c" UNIQUE ("student_id", "parent_id"), CONSTRAINT "PK_3f3fbf0307e277adf3e90495435" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_ab5687be754283635fffe3692e" ON "student_parents" ("student_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_d4d691ddbc51607ae462b68e16" ON "student_parents" ("parent_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_b2d8a4832d31fa641ec667374b" ON "student_parents" ("relationship") `);
        await queryRunner.query(`CREATE TABLE "student_promotions" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "student_id" uuid NOT NULL, "from_class_id" uuid NOT NULL, "to_class_id" uuid NOT NULL, "year" character varying(9) NOT NULL, "remarks" text, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), "studentId" uuid, "fromClassId" uuid, "toClassId" uuid, CONSTRAINT "PK_b1f7041c5f21cff8bf7947275b7" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_8b5a02b2d1bd921d1343e0751e" ON "student_promotions" ("student_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_1f6fecc9cb339fdf3baa72106f" ON "student_promotions" ("from_class_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_b897ed65b14f94884075483b73" ON "student_promotions" ("to_class_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_3c0fdbba2b5ad35458ddac8af5" ON "student_promotions" ("year") `);
        await queryRunner.query(`CREATE TABLE "students" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "user_id" uuid NOT NULL, "matricule" character varying(20) NOT NULL, "enrollment_date" date NOT NULL, "photo" text, "marital_status" character varying(20), "father_name" character varying(100), "mother_name" character varying(100), "tutor_name" character varying(100), "tutor_phone" character varying(20), "address" text, "emergency_contact" character varying(100), "notes" text, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_fb3eff90b11bddf7285f9b4e281" UNIQUE ("user_id"), CONSTRAINT "UQ_72985b50b5a897ee0ea6a3536cd" UNIQUE ("matricule"), CONSTRAINT "PK_7d7f07271ad4ce999880713f05e" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_fb3eff90b11bddf7285f9b4e28" ON "students" ("user_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_72985b50b5a897ee0ea6a3536c" ON "students" ("matricule") `);
        await queryRunner.query(`CREATE INDEX "IDX_f02c3d198bd4cfafea78366b65" ON "students" ("enrollment_date") `);
        await queryRunner.query(`CREATE TABLE "staff" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "user_id" uuid NOT NULL, "matricule" character varying(20) NOT NULL, "hire_date" date NOT NULL, "position" character varying(50) NOT NULL, "photo" text, "marital_status" character varying(20), "address" text, "emergency_contact" character varying(100), "notes" text, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_cec9365d9fc3a3409158b645f2e" UNIQUE ("user_id"), CONSTRAINT "UQ_a9de5f1c1623ab6169408ed4159" UNIQUE ("matricule"), CONSTRAINT "PK_e4ee98bb552756c180aec1e854a" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_cec9365d9fc3a3409158b645f2" ON "staff" ("user_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_a9de5f1c1623ab6169408ed415" ON "staff" ("matricule") `);
        await queryRunner.query(`CREATE INDEX "IDX_cd84afbdfaeefe66740ec2fa27" ON "staff" ("hire_date") `);
        await queryRunner.query(`CREATE INDEX "IDX_7390f81e2272a8da0aa825ce58" ON "staff" ("position") `);
        await queryRunner.query(`CREATE TABLE "grade_complaint_history" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "complaint_id" uuid NOT NULL, "old_score" numeric(5,2), "new_score" numeric(5,2), "changed_by" uuid NOT NULL, "changed_at" TIMESTAMP NOT NULL DEFAULT now(), "comment" text, CONSTRAINT "PK_1076d598f4110de7ae7f6dead25" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_4d212f739e47c5f2151985ed8d" ON "grade_complaint_history" ("complaint_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_52a0b364d5851f3fb88e13e431" ON "grade_complaint_history" ("changed_by") `);
        await queryRunner.query(`CREATE TYPE "public"."users_role_enum" AS ENUM('admin', 'super_admin', 'teacher', 'student', 'staff', 'parent')`);
        await queryRunner.query(`CREATE TABLE "users" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "username" character varying(50) NOT NULL, "email" character varying(100) NOT NULL, "first_name" character varying(50) NOT NULL, "last_name" character varying(50) NOT NULL, "gender" character varying(10), "birth_date" date, "phone" character varying(20), "password" character varying(255) NOT NULL, "role" "public"."users_role_enum" NOT NULL DEFAULT 'student', "is_active" boolean NOT NULL DEFAULT true, "created_at" TIMESTAMP NOT NULL DEFAULT now(), "updated_at" TIMESTAMP NOT NULL DEFAULT now(), CONSTRAINT "UQ_fe0bb3f6520ee0469504521e710" UNIQUE ("username"), CONSTRAINT "UQ_97672ac88f789774dd47f7c8be3" UNIQUE ("email"), CONSTRAINT "PK_a3ffb1c0c8416b9fc6f907b7433" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_fe0bb3f6520ee0469504521e71" ON "users" ("username") `);
        await queryRunner.query(`CREATE INDEX "IDX_97672ac88f789774dd47f7c8be" ON "users" ("email") `);
        await queryRunner.query(`CREATE INDEX "IDX_ace513fa30d485cfd25c11a9e4" ON "users" ("role") `);
        await queryRunner.query(`CREATE INDEX "IDX_20c7aea6112bef71528210f631" ON "users" ("is_active") `);
        await queryRunner.query(`CREATE TABLE "teacher_subjects" ("teacher_id" uuid NOT NULL, "subject_id" uuid NOT NULL, CONSTRAINT "PK_9e05964fe6f2598b643470c2067" PRIMARY KEY ("teacher_id", "subject_id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_6675136306b9111126bbdbbaba" ON "teacher_subjects" ("teacher_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_f35ef96bfb3a84b712722d6db7" ON "teacher_subjects" ("subject_id") `);
        await queryRunner.query(`ALTER TABLE "teaching_assignments" ADD CONSTRAINT "FK_7eb84b6d68b1db6cc46b5fcea98" FOREIGN KEY ("teacher_id") REFERENCES "teachers"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "teaching_assignments" ADD CONSTRAINT "FK_074e7e672063e0b76786f67cd00" FOREIGN KEY ("class_subject_id") REFERENCES "class_subjects"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "teachers" ADD CONSTRAINT "FK_4668d4752e6766682d1be0b346f" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "terms" ADD CONSTRAINT "FK_8ccf58120321db1b8293c4f3575" FOREIGN KEY ("schoolYearId") REFERENCES "school_years"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "assessment_results" ADD CONSTRAINT "FK_053245407efdbd008dbfe227053" FOREIGN KEY ("assessment_id") REFERENCES "assessments"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "assessment_results" ADD CONSTRAINT "FK_2ab229464f61751c37720261dcf" FOREIGN KEY ("student_id") REFERENCES "students"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "grade_complaints" ADD CONSTRAINT "FK_34d2b5c89e1a3b4f458dcbc9c70" FOREIGN KEY ("student_id") REFERENCES "students"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "grade_complaints" ADD CONSTRAINT "FK_04342a18ea7141b9069f460eb1f" FOREIGN KEY ("assessment_id") REFERENCES "assessments"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "assessment_subjects" ADD CONSTRAINT "FK_32c0056f4a8acc773ab38fb3e5f" FOREIGN KEY ("assessment_id") REFERENCES "assessments"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "assessment_subjects" ADD CONSTRAINT "FK_37ece249a758b7bc5a8a9ae1263" FOREIGN KEY ("uploaded_by") REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "assessments" ADD CONSTRAINT "FK_69fa5c748abdc2d8e562c4f5b90" FOREIGN KEY ("termId") REFERENCES "terms"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "assessments" ADD CONSTRAINT "FK_a7119fde4f58ca883343851671f" FOREIGN KEY ("classSubjectId") REFERENCES "class_subjects"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "class_subjects" ADD CONSTRAINT "FK_433f93dd22b685e59c285726a1f" FOREIGN KEY ("class_id") REFERENCES "classes"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "class_subjects" ADD CONSTRAINT "FK_9d8971acdcc64a1703357a00759" FOREIGN KEY ("subject_id") REFERENCES "subjects"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "classes" ADD CONSTRAINT "FK_fbc2a60d09eaf6d4cbb9f326932" FOREIGN KEY ("class_category_id") REFERENCES "class_category"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "student_classes" ADD CONSTRAINT "FK_09b94eccbdedd86b77d54daaeb8" FOREIGN KEY ("student_id") REFERENCES "students"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "student_classes" ADD CONSTRAINT "FK_250de2754beaff18091a60a6654" FOREIGN KEY ("class_id") REFERENCES "classes"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parents" ADD CONSTRAINT "FK_c94c3cea9b43a18c81269ded41d" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "student_parents" ADD CONSTRAINT "FK_ab5687be754283635fffe3692ee" FOREIGN KEY ("student_id") REFERENCES "students"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "student_parents" ADD CONSTRAINT "FK_d4d691ddbc51607ae462b68e16c" FOREIGN KEY ("parent_id") REFERENCES "parents"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "student_promotions" ADD CONSTRAINT "FK_5bb49b0b9f660e400bba2875d07" FOREIGN KEY ("studentId") REFERENCES "students"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "student_promotions" ADD CONSTRAINT "FK_dc4204329210a246f88d339984f" FOREIGN KEY ("fromClassId") REFERENCES "classes"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "student_promotions" ADD CONSTRAINT "FK_b99d4b2364e460808da39548bd0" FOREIGN KEY ("toClassId") REFERENCES "classes"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "students" ADD CONSTRAINT "FK_fb3eff90b11bddf7285f9b4e281" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "staff" ADD CONSTRAINT "FK_cec9365d9fc3a3409158b645f2e" FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "grade_complaint_history" ADD CONSTRAINT "FK_4d212f739e47c5f2151985ed8de" FOREIGN KEY ("complaint_id") REFERENCES "grade_complaints"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "grade_complaint_history" ADD CONSTRAINT "FK_52a0b364d5851f3fb88e13e4317" FOREIGN KEY ("changed_by") REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "teacher_subjects" ADD CONSTRAINT "FK_6675136306b9111126bbdbbaba7" FOREIGN KEY ("teacher_id") REFERENCES "teachers"("id") ON DELETE CASCADE ON UPDATE CASCADE`);
        await queryRunner.query(`ALTER TABLE "teacher_subjects" ADD CONSTRAINT "FK_f35ef96bfb3a84b712722d6db70" FOREIGN KEY ("subject_id") REFERENCES "subjects"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
    }

    public async down(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE "teacher_subjects" DROP CONSTRAINT "FK_f35ef96bfb3a84b712722d6db70"`);
        await queryRunner.query(`ALTER TABLE "teacher_subjects" DROP CONSTRAINT "FK_6675136306b9111126bbdbbaba7"`);
        await queryRunner.query(`ALTER TABLE "grade_complaint_history" DROP CONSTRAINT "FK_52a0b364d5851f3fb88e13e4317"`);
        await queryRunner.query(`ALTER TABLE "grade_complaint_history" DROP CONSTRAINT "FK_4d212f739e47c5f2151985ed8de"`);
        await queryRunner.query(`ALTER TABLE "staff" DROP CONSTRAINT "FK_cec9365d9fc3a3409158b645f2e"`);
        await queryRunner.query(`ALTER TABLE "students" DROP CONSTRAINT "FK_fb3eff90b11bddf7285f9b4e281"`);
        await queryRunner.query(`ALTER TABLE "student_promotions" DROP CONSTRAINT "FK_b99d4b2364e460808da39548bd0"`);
        await queryRunner.query(`ALTER TABLE "student_promotions" DROP CONSTRAINT "FK_dc4204329210a246f88d339984f"`);
        await queryRunner.query(`ALTER TABLE "student_promotions" DROP CONSTRAINT "FK_5bb49b0b9f660e400bba2875d07"`);
        await queryRunner.query(`ALTER TABLE "student_parents" DROP CONSTRAINT "FK_d4d691ddbc51607ae462b68e16c"`);
        await queryRunner.query(`ALTER TABLE "student_parents" DROP CONSTRAINT "FK_ab5687be754283635fffe3692ee"`);
        await queryRunner.query(`ALTER TABLE "parents" DROP CONSTRAINT "FK_c94c3cea9b43a18c81269ded41d"`);
        await queryRunner.query(`ALTER TABLE "student_classes" DROP CONSTRAINT "FK_250de2754beaff18091a60a6654"`);
        await queryRunner.query(`ALTER TABLE "student_classes" DROP CONSTRAINT "FK_09b94eccbdedd86b77d54daaeb8"`);
        await queryRunner.query(`ALTER TABLE "classes" DROP CONSTRAINT "FK_fbc2a60d09eaf6d4cbb9f326932"`);
        await queryRunner.query(`ALTER TABLE "class_subjects" DROP CONSTRAINT "FK_9d8971acdcc64a1703357a00759"`);
        await queryRunner.query(`ALTER TABLE "class_subjects" DROP CONSTRAINT "FK_433f93dd22b685e59c285726a1f"`);
        await queryRunner.query(`ALTER TABLE "assessments" DROP CONSTRAINT "FK_a7119fde4f58ca883343851671f"`);
        await queryRunner.query(`ALTER TABLE "assessments" DROP CONSTRAINT "FK_69fa5c748abdc2d8e562c4f5b90"`);
        await queryRunner.query(`ALTER TABLE "assessment_subjects" DROP CONSTRAINT "FK_37ece249a758b7bc5a8a9ae1263"`);
        await queryRunner.query(`ALTER TABLE "assessment_subjects" DROP CONSTRAINT "FK_32c0056f4a8acc773ab38fb3e5f"`);
        await queryRunner.query(`ALTER TABLE "grade_complaints" DROP CONSTRAINT "FK_04342a18ea7141b9069f460eb1f"`);
        await queryRunner.query(`ALTER TABLE "grade_complaints" DROP CONSTRAINT "FK_34d2b5c89e1a3b4f458dcbc9c70"`);
        await queryRunner.query(`ALTER TABLE "assessment_results" DROP CONSTRAINT "FK_2ab229464f61751c37720261dcf"`);
        await queryRunner.query(`ALTER TABLE "assessment_results" DROP CONSTRAINT "FK_053245407efdbd008dbfe227053"`);
        await queryRunner.query(`ALTER TABLE "terms" DROP CONSTRAINT "FK_8ccf58120321db1b8293c4f3575"`);
        await queryRunner.query(`ALTER TABLE "teachers" DROP CONSTRAINT "FK_4668d4752e6766682d1be0b346f"`);
        await queryRunner.query(`ALTER TABLE "teaching_assignments" DROP CONSTRAINT "FK_074e7e672063e0b76786f67cd00"`);
        await queryRunner.query(`ALTER TABLE "teaching_assignments" DROP CONSTRAINT "FK_7eb84b6d68b1db6cc46b5fcea98"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_f35ef96bfb3a84b712722d6db7"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_6675136306b9111126bbdbbaba"`);
        await queryRunner.query(`DROP TABLE "teacher_subjects"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_20c7aea6112bef71528210f631"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_ace513fa30d485cfd25c11a9e4"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_97672ac88f789774dd47f7c8be"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_fe0bb3f6520ee0469504521e71"`);
        await queryRunner.query(`DROP TABLE "users"`);
        await queryRunner.query(`DROP TYPE "public"."users_role_enum"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_52a0b364d5851f3fb88e13e431"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_4d212f739e47c5f2151985ed8d"`);
        await queryRunner.query(`DROP TABLE "grade_complaint_history"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_7390f81e2272a8da0aa825ce58"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_cd84afbdfaeefe66740ec2fa27"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_a9de5f1c1623ab6169408ed415"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_cec9365d9fc3a3409158b645f2"`);
        await queryRunner.query(`DROP TABLE "staff"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_f02c3d198bd4cfafea78366b65"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_72985b50b5a897ee0ea6a3536c"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_fb3eff90b11bddf7285f9b4e28"`);
        await queryRunner.query(`DROP TABLE "students"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_3c0fdbba2b5ad35458ddac8af5"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_b897ed65b14f94884075483b73"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_1f6fecc9cb339fdf3baa72106f"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_8b5a02b2d1bd921d1343e0751e"`);
        await queryRunner.query(`DROP TABLE "student_promotions"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_b2d8a4832d31fa641ec667374b"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_d4d691ddbc51607ae462b68e16"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_ab5687be754283635fffe3692e"`);
        await queryRunner.query(`DROP TABLE "student_parents"`);
        await queryRunner.query(`DROP TYPE "public"."student_parents_relationship_enum"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_c94c3cea9b43a18c81269ded41"`);
        await queryRunner.query(`DROP TABLE "parents"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_0f3d7aaa500b257483674cc898"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_fe3b07f79392a7333d197c8852"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_250de2754beaff18091a60a665"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_09b94eccbdedd86b77d54daaeb"`);
        await queryRunner.query(`DROP TABLE "student_classes"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_bebfac8b20c611dc0a5ffeca97"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_7f3d4d1ac00ffae553798f09d1"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_cf7491878e0fca859943862998"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_1f3940af28a76098f31004f03c"`);
        await queryRunner.query(`DROP TABLE "classes"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_57121e4285ce95dcb67dce5f77"`);
        await queryRunner.query(`DROP TABLE "class_category"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_99dddf68bda3b92f23f0039c36"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_9d8971acdcc64a1703357a0075"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_433f93dd22b685e59c285726a1"`);
        await queryRunner.query(`DROP TABLE "class_subjects"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_949e337542feac3095503a3693"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_35e24da9b85a5fa69de3e049b7"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_fa6c13bd0f1077f9bd02235112"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_44e86abcddcbf3cbdb90502c69"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_2b73c535109b7f105941e83b81"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_0fc9facafe432c9a5fcb6a00d4"`);
        await queryRunner.query(`DROP TABLE "assessments"`);
        await queryRunner.query(`DROP TYPE "public"."assessments_type_enum"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_37ece249a758b7bc5a8a9ae126"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_32c0056f4a8acc773ab38fb3e5"`);
        await queryRunner.query(`DROP TABLE "assessment_subjects"`);
        await queryRunner.query(`DROP TYPE "public"."assessment_subjects_file_type_enum"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_f9f21013dce950782fced82b00"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_04342a18ea7141b9069f460eb1"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_34d2b5c89e1a3b4f458dcbc9c7"`);
        await queryRunner.query(`DROP TABLE "grade_complaints"`);
        await queryRunner.query(`DROP TYPE "public"."grade_complaints_status_enum"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_fe3eef76d2c914c686d29ccde7"`);
        await queryRunner.query(`DROP TABLE "assessment_results"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_a24ac15b9a8c74a4c7e8fdfb22"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_e5f8a2f92f738911997eebc794"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_6811439bf289b3bb6de197648b"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_c7ac94655c7dc1edd0b5b01547"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_79b56b84207dc3c5510bb093d3"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_3ee8b061e5cb4972f9a2953a95"`);
        await queryRunner.query(`DROP TABLE "terms"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_5e9b2616fdad7b0d3c33c93fe0"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_478a2d98422fb3b99dcb31b6e6"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_975c55d642528a2f478e8d7666"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_687611dadc1a5966e0365e4f49"`);
        await queryRunner.query(`DROP TABLE "school_years"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_542cbba74dde3c82ab49c57310"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_47a287fe64bd0e1027e603c335"`);
        await queryRunner.query(`DROP TABLE "subjects"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_bc8ceddb4c4419b52ff7ff5c3b"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_4da9777c79b35eb3a0fcdcd833"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_4668d4752e6766682d1be0b346"`);
        await queryRunner.query(`DROP TABLE "teachers"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_360b1f9ed98b16ad3f076084cf"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_e0f83525a7bfd679c02107652c"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_074e7e672063e0b76786f67cd0"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_7eb84b6d68b1db6cc46b5fcea9"`);
        await queryRunner.query(`DROP TABLE "teaching_assignments"`);
    }

}
